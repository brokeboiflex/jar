{"version":3,"file":"index.esm.js","sources":["../src/router.tsx"],"sourcesContent":["import { JSX } from \"preact/jsx-runtime\";\r\nimport { createJSONStorage, persist, StateStorage } from \"zustand/middleware\";\r\nimport { create } from \"zustand\";\r\nimport { isValidElement } from \"preact\";\r\nexport interface RouterProps {\r\n  children: JSX.Element | JSX.Element[];\r\n  routerStore: () => RouterState;\r\n}\r\nexport interface RouteProps {\r\n  path: string;\r\n  component: JSX.Element;\r\n}\r\n\r\nexport interface RouterState {\r\n  location: string;\r\n  navigate: (route: string) => void;\r\n}\r\n\r\nexport function createRouterStore(storage: StateStorage): () => RouterState {\r\n  // @ts-ignore\r\n  return create(\r\n    persist(\r\n      (set) => ({\r\n        location: \"/\", // Default route\r\n        navigate: (route: string) => set({ location: route }),\r\n      }),\r\n      {\r\n        name: \"router-storage\", // Name of the item in chrome.storage.local\r\n        storage: createJSONStorage(() => storage),\r\n      }\r\n    )\r\n  );\r\n}\r\nexport function Router({ children, routerStore }: RouterProps) {\r\n  const { location } = routerStore();\r\n  console.log(location);\r\n\r\n  // Filter children to get Route components\r\n  const routes = Array.isArray(children) ? children : [children];\r\n  const routeElements = routes.filter(\r\n    (child) => isValidElement(child) && (child as any).type === Route\r\n  );\r\n\r\n  // Find the component that matches the current route\r\n  const currentRoute = routeElements.find((route) => {\r\n    const routeProps = (route as any).props as RouteProps;\r\n    return routeProps.path === location;\r\n  });\r\n\r\n  return currentRoute ? (currentRoute as any).props.component : null;\r\n}\r\n\r\n// Route component\r\n// @ts-ignore\r\nexport function Route({ path, component }: RouteProps) {\r\n  return null;\r\n}\r\n"],"names":["createRouterStore","storage","create","persist","set","location","navigate","route","name","createJSONStorage","Router","_ref","children","routerStore","console","log","currentRoute","Array","isArray","filter","child","isValidElement","type","Route","find","props","path","component","_ref2"],"mappings":"6IAkBgB,SAAAA,EAAkBC,GAEhC,OAAOC,EACLC,EACE,SAACC,GAAG,MAAM,CACRC,SAAU,IACVC,SAAU,SAACC,GAAkB,OAAAH,EAAI,CAAEC,SAAUE,GAAQ,EACtD,EACD,CACEC,KAAM,iBACNP,QAASQ,EAAkB,WAAM,OAAAR,CAAO,KAIhD,UACgBS,EAAMC,GAAuC,IAApCC,EAAQD,EAARC,SACfP,GAAaQ,EADuBF,EAAXE,eACzBR,SACRS,QAAQC,IAAIV,GAGZ,IAMMW,GANSC,MAAMC,QAAQN,GAAYA,EAAW,CAACA,IACxBO,OAC3B,SAACC,GAAK,OAAKC,EAAeD,IAAWA,EAAcE,OAASC,CAAK,GAIhCC,KAAK,SAACjB,GAEvC,OADoBA,EAAckB,MAChBC,OAASrB,CAC7B,GAEA,OAAOW,EAAgBA,EAAqBS,MAAME,UAAY,IAChE,CAIgB,SAAAJ,EAAKK,GACnB,OACF,IAAA"}